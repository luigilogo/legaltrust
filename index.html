<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LegalTrust | Misura la tua integrit√†</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        :root {
            --primary-color: #3b5998;
            --secondary-color: #f7f7f7;
            --text-color: #333;
            --light-text: #fff;
            --gradient-bg: linear-gradient(135deg, #3b5998, #8b9dc3);
            --shadow-effect: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition-fast: 0.3s ease-in-out;
            --transition-slow: 0.8s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            color: var(--text-color);
            background-color: #fff;
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        
        /* Navbar migliorata */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: background 0.3s ease;
        }

        .header .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
        }

        .header .logo span {
            margin-right: 8px;
            font-size: 1.8rem;
        }

        .header .nav a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            margin-left: 25px;
            padding: 8px 15px;
            border-radius: 50px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .header .nav a:hover {
            background-color: var(--primary-color);
            color: var(--light-text);
            box-shadow: 0 5px 15px rgba(59, 89, 152, 0.4);
            transform: translateY(-2px);
        }

        .hero-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: var(--gradient-bg);
            color: var(--light-text);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), transparent, transparent);
            animation: flow 15s linear infinite;
            z-index: 1;
        }

        @keyframes flow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .score-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin: 40px auto;
        }
        
        .score-wrapper {
            position: relative;
            width: 280px;
            height: 280px;
        }

        #score-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .score-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5em;
            font-weight: 700;
        }
        
        .score-breakdown {
            width: 350px;
            padding: 20px;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            box-shadow: var(--shadow-effect);
            text-align: left;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s, transform 1s;
        }

        .score-breakdown.active {
            opacity: 1;
            transform: translateY(0);
        }

        .bar-container {
            margin-bottom: 15px;
        }

        .bar-label {
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }

        .bar {
            height: 8px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            background-color: #fff;
            width: 0;
            transition: width 1.5s var(--transition-slow);
        }

        .section {
            padding: 80px 5%;
            text-align: center;
        }
        
        .advantages-section {
            padding: 80px 5%;
            background-color: #f7f7f7;
            text-align: left;
        }
        
        .advantage-category {
            margin-bottom: 40px;
        }
        
        .advantage-category h3 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            display: inline-block;
            padding-bottom: 5px;
        }
        
        .advantage-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 25px;
        }
        
        .advantage-icon {
            font-size: 2em;
            color: var(--primary-color);
            margin-right: 15px;
            flex-shrink: 0;
        }

        .dark-section {
            background-color: #222;
            color: var(--light-text);
        }

        .blockchain-animation {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 50px 0;
            flex-wrap: nowrap;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .blockchain-node {
            display: inline-block;
            flex-direction: column;
            align-items: center;
            text-align: center;
            background-color: var(--secondary-color);
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow-effect);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s var(--transition-slow);
            margin: 10px;
            white-space: normal;
        }

        .blockchain-node.active {
            opacity: 1;
            transform: translateY(0);
        }

        .blockchain-arrow {
            display: inline-block;
            font-size: 2em;
            color: var(--primary-color);
            margin: 0 10px;
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            from { transform: scale(1); opacity: 0.7; }
            to { transform: scale(1.1); opacity: 1; }
        }

        /* Sezione AI migliorata */
        #ai-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            margin-top: 50px;
        }
        
        .ai-dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            width: 100%;
            max-width: 900px;
        }
        
        .ai-card {
            background-color: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(5px);
            padding: 20px;
            border-radius: 10px;
            width: 250px;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }

        .ai-card.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .ai-card h4 {
            font-weight: 600;
            font-size: 1.1em;
            margin-top: 0;
        }
        
        .ai-card .score {
            font-size: 2.5em;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .ai-card .status {
            font-size: 0.9em;
            font-style: italic;
        }
        
        #ai-text-overlay {
            color: #fff;
            text-align: center;
            font-size: 1.5em;
            font-weight: 600;
            animation: fadeInOut 2s infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .ai-details-container {
            margin-top: 30px;
            width: 100%;
            max-width: 900px;
            text-align: center;
            transition: all 0.5s ease;
        }
        
        .ai-details-content {
            display: none;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: left;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .ai-details-content.show {
            display: block;
            opacity: 1;
        }
        
        .ai-details-content canvas {
            max-width: 100%;
            height: auto;
        }

        /* Sezione Bilancio migliorata */
        .balance-container {
            max-width: 1200px;
            margin: 50px auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            gap: 50px;
        }

        .balance-info {
            max-width: 450px;
            text-align: left;
            margin-top: 20px;
        }

        .balance-charts {
            display: flex;
            flex-direction: column;
            gap: 40px;
            width: 100%;
            max-width: 600px;
        }
        
        .chart-box {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
        }
        
        .chart-box.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Bottone Torna su */
        #scrollToTopBtn {
            display: none;
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 99;
            border: none;
            outline: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            padding: 15px;
            border-radius: 50%;
            font-size: 18px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        #scrollToTopBtn:hover {
            background-color: #2c447a;
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="logo">
            <span>&#9876;</span> LegalTrust
        </div>
        <nav class="nav">
            <a href="#score">Score</a>
            <a href="#blockchain">Trasparenza</a>
            <a href="#ai">Analisi AI</a>
            <a href="#bilancio">Bilancio</a>
            <a href="#benefits">Benefici</a>
        </nav>
    </header>

    <main>
        <section id="score" class="hero-section">
            <h1>Il tuo LegalScore. La tua Garanzia.</h1>
            <div class="score-container">
                <div class="score-wrapper">
                    <canvas id="score-canvas"></canvas>
                    <div id="legalScoreValue" class="score-value" data-final-score="95">0</div>
                    <p class="score-label">LegalScore‚Ñ¢</p>
                </div>
                <div class="score-breakdown">
                    <h3>Dettaglio del Punteggio</h3>
                    <div class="bar-container">
                        <div class="bar-label"><span>Governance & Compliance</span> <span class="score-value-breakdown" data-score="20">0</span></div>
                        <div class="bar"><div class="bar-fill" data-score="20"></div></div>
                    </div>
                    <div class="bar-container">
                        <div class="bar-label"><span>Trasparenza Capitale Umano</span> <span class="score-value-breakdown" data-score="20">0</span></div>
                        <div class="bar"><div class="bar-fill" data-score="20"></div></div>
                    </div>
                    <div class="bar-container">
                        <div class="bar-label"><span>Impatto sul Territorio</span> <span class="score-value-breakdown" data-score="15">0</span></div>
                        <div class="bar"><div class="bar-fill" data-score="15"></div></div>
                    </div>
                    <div class="bar-container">
                        <div class="bar-label"><span>Integrit√† di Filiera & Clienti</span> <span class="score-value-breakdown" data-score="40">0</span></div>
                        <div class="bar"><div class="bar-fill" data-score="40"></div></div>
                    </div>
                </div>
            </div>
            <p class="score-description">Un punteggio dinamico che certifica l'integrit√† della tua azienda, basato su un'analisi multidimensionale.</p>
        </section>

        <section id="blockchain" class="section">
            <h2>Trasparenza Immutabile.</h2>
            <p>Ogni passo della tua filiera, un blocco di fiducia.</p>
            <div class="blockchain-animation">
                </div>
        </section>

        <section id="ai" class="section dark-section">
            <h2>Analisi Predittiva. L'AI che Vede nel Futuro.</h2>
            <p>Il nostro algoritmo scansiona miliardi di dati in tempo reale per identificare e neutralizzare rischi prima che diventino un problema.</p>
            <div id="ai-container">
                <div class="ai-dashboard">
                    <div class="ai-card" id="geo-card" style="animation-delay: 0.2s;">
                        <h4>Rischio Geopolitico</h4>
                        <div class="score" id="geoScore"></div>
                        <div class="status" id="geoStatus"></div>
                    </div>
                    <div class="ai-card" id="reputation-card" style="animation-delay: 0.4s;">
                        <h4>Rischio Reputazionale</h4>
                        <div class="score" id="reputationScore"></div>
                        <div class="status" id="reputationStatus"></div>
                    </div>
                    <div class="ai-card" id="sustainability-card" style="animation-delay: 0.6s;">
                        <h4>Rischio di Sostenibilit√†</h4>
                        <div class="score" id="sustainabilityScore"></div>
                        <div class="status" id="sustainabilityStatus"></div>
                    </div>
                </div>
                <div class="ai-details-container">
                    <div class="ai-details-content" id="geo-details">
                        <h4>Mappa del Rischio Geopolitico</h4>
                        <p>Il nostro sistema ha identificato delle tensioni in <span style="color: #F44336; font-weight: bold;">tre aree geografiche</span> con cui i tuoi fornitori diretti e indiretti interagiscono. Il rischio √® valutato alto, ma gestibile con una diversificazione strategica della catena di fornitura.</p>
                        <canvas id="geoChart"></canvas>
                    </div>
                    <div class="ai-details-content" id="reputation-details">
                        <h4>Analisi del Sentiment Online</h4>
                        <p>Il sentiment nei confronti del tuo brand √® stabile, ma una recente campagna diffamatoria online ha causato un picco negativo temporaneo. Il nostro algoritmo ha isolato la fonte e suggerisce una strategia di comunicazione mirata per ripristinare il valore reputazionale.</p>
                        <canvas id="reputationChart"></canvas>
                    </div>
                    <div class="ai-details-content" id="sustainability-details">
                        <h4>Performance di Sostenibilit√†</h4>
                        <p>Le tue pratiche di produzione mostrano un'alta efficienza idrica, ma il consumo energetico √® superiore alla media del settore. L'algoritmo suggerisce un potenziale di risparmio del 15% con l'adozione di nuove tecnologie rinnovabili.</p>
                        <canvas id="sustainabilityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="bilancio" class="section">
            <h2>Salute Finanziaria & Integrit√† Legale.</h2>
            <p>Una solida governance non √® solo etica, √® anche un vantaggio competitivo che si riflette nei bilanci.</p>
            <div class="balance-container">
                <div class="balance-info">
                    <h3>Indicatori e Interpretazione</h3>
                    <p>La nostra analisi incrocia il **LegalScore** con gli indicatori di bilancio per fornire una visione completa della solidit√† aziendale.</p>
                    <div class="indicator-data">
                        <p><strong>ROE:</strong> <span class="indicator-value roe">0%</span></p>
                        <p><strong>ROI:</strong> <span class="indicator-value roi">0%</span></p>
                        <p><strong>D/E Ratio:</strong> <span class="indicator-value de-ratio">0%</span></p>
                        <p class="analysis-comment">Un alto LegalScore (<span class="score-percent">95%</span>) √® correlato a un'elevata redditivit√† del capitale (ROE) e a una gestione efficiente del debito (D/E Ratio), dimostrando la solidit√† e l'affidabilit√† dell'azienda.</p>
                    </div>
                </div>
                <div class="balance-charts">
                    <div class="chart-box">
                        <canvas id="balanceBarChart"></canvas>
                    </div>
                    <div class="chart-box" style="animation-delay: 0.3s;">
                        <canvas id="balanceLineChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="benefits" class="advantages-section">
            <h2>Perch√© LegalTrust? I Vantaggi che contano.</h2>
            <p>La nostra consulenza non √® solo una certificazione, ma un vero e proprio investimento nel futuro della tua azienda.</p>
            <div class="advantage-category">
                <h3>Vantaggi Economici e Finanziari</h3>
                <div class="advantage-item">
                    <span class="advantage-icon">üè¶</span>
                    <div>
                        <h4>Accesso Privilegiato al Credito</h4>
                        <p>Un alto **LegalScore** √® una garanzia di affidabilit√†. Banche e istituzioni finanziarie, riducendo il rischio di default, possono offrire **condizioni di credito pi√π favorevoli**, con tassi di interesse pi√π bassi e processi di approvazione pi√π rapidi.</p>
                    </div>
                </div>
                <div class="advantage-item">
                    <span class="advantage-icon">üõ°Ô∏è</span>
                    <div>
                        <h4>Riduzione dei Premi Assicurativi</h4>
                        <p>Le compagnie assicurative riconoscono la tua integrit√†. La dimostrazione di una gestione solida e trasparente riduce il rischio per l'assicuratore, che premia l'azienda virtuosa con **premi pi√π bassi** sulle polizze.</p>
                    </div>
                </div>
                <div class="advantage-item">
                    <span class="advantage-icon">üìâ</span>
                    <div>
                        <h4>Ottimizzazione della Gestione dei Rischi</h4>
                        <p>La nostra piattaforma √® uno strumento di analisi del rischio in tempo reale. Potrai identificare e prevenire costose interruzioni della catena di approvvigionamento, sanzioni legali o danni reputazionali causati da associazioni con soggetti a rischio.</p>
                    </div>
                </div>
            </div>
            <div class="advantage-category">
                <h3>Vantaggi Competitivi e di Mercato</h3>
                <div class="advantage-item">
                    <span class="advantage-icon">üèÜ</span>
                    <div>
                        <h4>Differenziazione Competitiva</h4>
                        <p>In un mercato saturo, la legalit√† diventa un fattore di differenziazione. Un'azienda con un alto **LegalScore** pu√≤ promuoversi come un'alternativa sicura e affidabile, guadagnando un vantaggio decisivo sulla concorrenza.</p>
                    </div>
                </div>
                <div class="advantage-item">
                    <span class="advantage-icon">‚ù§Ô∏è</span>
                    <div>
                        <h4>Fidelizzazione del Cliente</h4>
                        <p>Il nostro sistema di rating permette ai consumatori di scegliere consapevolmente. I clienti sono disposti a premiare le aziende oneste, creando un legame di fiducia duraturo che si traduce in una clientela fedele e in crescita.</p>
                    </div>
                </div>
                <div class="advantage-item">
                    <span class="advantage-icon">üíº</span>
                    <div>
                        <h4>Vantaggio Negli Appalti Pubblici</h4>
                        <p>I dati di LegalTrust possono semplificare i processi di gara. Le stazioni appaltanti possono pre-selezionare le aziende con un alto **LegalScore**, riducendo la burocrazia e aumentando le tue possibilit√† di successo.</p>
                    </div>
                </div>
            </div>
            <div class="advantage-category">
                <h3>Vantaggi Reputazionali e di "Brand Value"</h3>
                <div class="advantage-item">
                    <span class="advantage-icon">‚ú®</span>
                    <div>
                        <h4>Crescita della Reputazione Aziendale</h4>
                        <p>Essere un'azienda "certificata" dalla nostra piattaforma costruisce una reputazione di integrit√†. Non attiri solo clienti, ma anche i migliori talenti, che cercano di lavorare per aziende con valori forti e una missione chiara.</p>
                    </div>
                </div>
                <div class="advantage-item">
                    <span class="advantage-icon">üìà</span>
                    <div>
                        <h4>Aumento del Valore del Brand</h4>
                        <p>La reputazione di legalit√† e trasparenza si riflette direttamente nel valore del tuo brand. Un brand percepito come etico e affidabile pu√≤ ottenere valutazioni pi√π alte e attrarre investitori pi√π solidi e a lungo termine.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <button onclick="scrollToTop()" id="scrollToTopBtn" title="Torna su">&#8593;</button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (entry.target.id === 'score') {
                            animateScore(95);
                            drawScoreCircle();
                            animateScoreBreakdown();
                        } else if (entry.target.id === 'blockchain') {
                            animateBlockchain();
                        } else if (entry.target.id === 'ai') {
                            animateAI();
                        } else if (entry.target.id === 'bilancio') {
                            animateBalanceAnalysis();
                        }
                    }
                });
            }, { threshold: 0.5 });
            
            observer.observe(document.getElementById('score'));
            observer.observe(document.getElementById('blockchain'));
            observer.observe(document.getElementById('ai'));
            observer.observe(document.getElementById('bilancio'));
            
            // Pulsante torna su
            const scrollToTopBtn = document.getElementById("scrollToTopBtn");
            window.onscroll = function() { scrollFunction() };
            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    scrollToTopBtn.style.display = "block";
                } else {
                    scrollToTopBtn.style.display = "none";
                }
            }
            window.scrollToTop = function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };


            function animateScore(finalScore) {
                const scoreElement = document.getElementById('legalScoreValue');
                const duration = 2000;
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    scoreElement.textContent = Math.floor(progress * finalScore);
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }

            function drawScoreCircle() {
                const canvas = document.getElementById('score-canvas');
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                const finalScore = parseInt(document.getElementById('legalScoreValue').dataset.final-score, 10);
                const radius = canvas.width / 2 - 10;
                const endAngle = (2 * Math.PI) * (finalScore / 100);
                let startTimestamp = null;

                function animate(timestamp) {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / 2000, 1);
                    const angle = progress * endAngle;
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.beginPath();
                    ctx.arc(canvas.width / 2, canvas.height / 2, radius, 0, 2 * Math.PI);
                    ctx.lineWidth = 15;
                    ctx.strokeStyle = '#e0e0e0';
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.arc(canvas.width / 2, canvas.height / 2, radius, -Math.PI / 2, -Math.PI / 2 + angle);
                    ctx.lineWidth = 15;
                    ctx.strokeStyle = '#3b5998';
                    ctx.stroke();
                    if (progress < 1) {
                        window.requestAnimationFrame(animate);
                    }
                }
                window.requestAnimationFrame(animate);
            }

            function animateScoreBreakdown() {
                const breakdown = document.querySelector('.score-breakdown');
                breakdown.classList.add('active');
                const bars = document.querySelectorAll('.bar-fill');
                const values = document.querySelectorAll('.score-value-breakdown');
                
                bars.forEach((bar, index) => {
                    const score = parseInt(bar.dataset.score, 10);
                    bar.style.width = `${score}%`; 
                    
                    let current = 0;
                    const interval = setInterval(() => {
                        if (current >= score) {
                            clearInterval(interval);
                            values[index].textContent = score;
                        } else {
                            current++;
                            values[index].textContent = current;
                        }
                    }, 20);
                });
            }

            function animateBlockchain() {
                const container = document.querySelector('.blockchain-animation');
                const nodesData = [
                    { icon: 'üçá', label: 'Origine: "Vigneto Siciliano"', data: 'ID Lotto: #F37A' },
                    { icon: 'üç∑', label: 'Lavorazione: "Cantine Legali S.p.a."', data: 'Data: 15/08/2025' },
                    { icon: 'üì¶', label: 'Logistica: "Spedizioni Trasparenti Ltd."', data: 'Codice: A4F-98Y' },
                    { icon: 'üèõÔ∏è', label: 'Certificazione: "LegalTrust"', data: 'Esito: Conforme' }
                ];

                container.innerHTML = '';
                nodesData.forEach((nodeData, index) => {
                    const node = document.createElement('div');
                    node.className = 'blockchain-node';
                    node.innerHTML = `
                        <div class="icon">${nodeData.icon}</div>
                        <p>${nodeData.label}</p>
                        <small>${nodeData.data}</small>
                    `;
                    container.appendChild(node);
                    if (index < nodesData.length - 1) {
                        const arrow = document.createElement('div');
                        arrow.className = 'blockchain-arrow';
                        arrow.innerHTML = '&#8594;';
                        container.appendChild(arrow);
                    }
                    setTimeout(() => {
                        node.classList.add('active');
                    }, index * 500);
                });
            }
            
            function animateAI() {
                const geoCard = document.getElementById('geo-card');
                const reputationCard = document.getElementById('reputation-card');
                const sustainabilityCard = document.getElementById('sustainability-card');

                const cards = [
                    { id: 'geo', el: geoCard, scoreEl: document.getElementById('geoScore'), statusEl: document.getElementById('geoStatus'), detailsEl: document.getElementById('geo-details'), data: { score: 15, status: 'Basso', color: '#4CAF50' } },
                    { id: 'reputation', el: reputationCard, scoreEl: document.getElementById('reputationScore'), statusEl: document.getElementById('reputationStatus'), detailsEl: document.getElementById('reputation-details'), data: { score: 65, status: 'Medio', color: '#FFC107' } },
                    { id: 'sustainability', el: sustainabilityCard, scoreEl: document.getElementById('sustainabilityScore'), statusEl: document.getElementById('sustainabilityStatus'), detailsEl: document.getElementById('sustainability-details'), data: { score: 90, status: 'Alto', color: '#F44336' } }
                ];
                
                cards.forEach(card => {
                    card.el.addEventListener('click', () => {
                        cards.forEach(c => c.detailsEl.classList.remove('show'));
                        card.detailsEl.classList.add('show');
                        
                        if (card.id === 'geo' && !window.geoChart) {
                            initGeoChart();
                        } else if (card.id === 'reputation' && !window.reputationChart) {
                            initReputationChart();
                        } else if (card.id === 'sustainability' && !window.sustainabilityChart) {
                            initSustainabilityChart();
                        }
                    });
                });
                
                // Animazione iniziale
                cards.forEach((card, index) => {
                    setTimeout(() => {
                        card.el.classList.add('active');
                        updateScore(card.scoreEl, card.data.score, card.statusEl, card.data.status, card.data.color);
                    }, 500 * (index + 1));
                });
            }
            
            function updateScore(element, value, statusEl, statusText, color) {
                let current = 0;
                const interval = setInterval(() => {
                    current += 5;
                    if (current >= value) {
                        clearInterval(interval);
                        element.textContent = value;
                        statusEl.textContent = statusText;
                        element.style.color = color;
                    } else {
                        element.textContent = current;
                    }
                }, 50);
            }
            
            function initGeoChart() {
                const ctx = document.getElementById('geoChart').getContext('2d');
                window.geoChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['Stabilit√† Politica', 'Regolamentazione', 'Calamit√† Naturali', 'Tensioni Sociali'],
                        datasets: [{
                            label: 'Livello di Rischio',
                            data: [1, 2, 3, 4],
                            backgroundColor: 'rgba(244, 67, 54, 0.2)',
                            borderColor: '#F44336',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: { r: { max: 5, min: 0 } },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            function initReputationChart() {
                const ctx = document.getElementById('reputationChart').getContext('2d');
                window.reputationChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu'],
                        datasets: [{
                            label: 'Sentiment Score',
                            data: [75, 80, 78, 60, 65, 70],
                            borderColor: '#FFC107',
                            tension: 0.4,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: { y: { min: 50, max: 90 } },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            function initSustainabilityChart() {
                const ctx = document.getElementById('sustainabilityChart').getContext('2d');
                window.sustainabilityChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Consumo Energetico', 'Efficienza Idrica', 'Emissioni'],
                        datasets: [
                            {
                                label: 'La tua Azienda',
                                data: [85, 95, 70],
                                backgroundColor: '#4CAF50',
                            },
                            {
                                label: 'Media del Settore',
                                data: [70, 80, 75],
                                backgroundColor: '#3b5998',
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        scales: { y: { min: 0, max: 100 } }
                    }
                });
            }


            function animateBalanceAnalysis() {
                const roeElement = document.querySelector('.indicator-value.roe');
                const roiElement = document.querySelector('.indicator-value.roi');
                const deElement = document.querySelector('.indicator-value.de-ratio');
                
                function animateValue(element, finalValue, duration = 1500) {
                    let start = 0;
                    const increment = finalValue / (duration / 10);
                    let current = start;
                    const interval = setInterval(() => {
                        current += increment;
                        if (current >= finalValue) {
                            clearInterval(interval);
                            element.textContent = `${finalValue}%`;
                        } else {
                            element.textContent = `${Math.floor(current)}%`;
                        }
                    }, 10);
                }

                animateValue(roeElement, 15);
                animateValue(roiElement, 12);
                animateValue(deElement, 40);

                const chartBox1 = document.querySelector('#bilancio .chart-box:nth-child(1)');
                const chartBox2 = document.querySelector('#bilancio .chart-box:nth-child(2)');
                chartBox1.classList.add('active');
                chartBox2.classList.add('active');
                
                // Grafico a Barre
                const barCtx = document.getElementById('balanceBarChart').getContext('2d');
                if (window.balanceBarChart) { window.balanceBarChart.destroy(); }
                window.balanceBarChart = new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Integrit√† Legale', 'Redditivit√† (ROE)', 'Redditivit√† (ROI)'],
                        datasets: [{
                            label: 'Correlazione con la Performance',
                            data: [95, 15, 12],
                            backgroundColor: ['#3b5998', '#4CAF50', '#FFC107'],
                            borderColor: '#fff',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Correlazione tra Legalit√† e Performance' }
                        },
                        scales: {
                            y: { beginAtZero: true, max: 100 }
                        }
                    }
                });
                
                // Grafico a Linee
                const lineCtx = document.getElementById('balanceLineChart').getContext('2d');
                if (window.balanceLineChart) { window.balanceLineChart.destroy(); }
                window.balanceLineChart = new Chart(lineCtx, {
                    type: 'line',
                    data: {
                        labels: ['2022', '2023', '2024', '2025'],
                        datasets: [{
                            label: 'Fatturato (‚Ç¨M)',
                            data: [5, 7, 9, 12],
                            fill: false,
                            borderColor: '#3b5998',
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: true }
                        },
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
